/*! df-tab-menu - v0.3.1 - Responsive tabs with dropdown menu - built 2016-04-27 - License MIT (http://www.opensource.org/licenses/MIT) */
!function(){"use strict";angular.module("digitalfondue.dftabmenu",[]).directive("dfTabMenu",["$window","$timeout",function(a,b){return{restrict:"A",compile:function(c,d){function e(a){return i?a:""}var f=a.document,g=c[0],h=g.tagName;if("UL"!==h&&"OL"!==h)throw"Wrong element: only OL and UL are supported by df-tab-menu";var i="bootstrap"===d.theme;angular.element(g).attr("role","tablist").addClass("df-tab-menu "+e("nav nav-tabs"));var j=angular.element(g.querySelector("li[data-more-menu-item]"));j.attr({role:"presentation"}),j.addClass(e("dropdown")),j.children().attr({"df-dropdown-toggle":"","aria-haspopup":"true","aria-expanded":"false"}),j.children().addClass("df-dropdown-toggle"),j.append("<"+h+' role="menu" aria-hidden="true" class="df-tab-menu-dropdown '+e("dropdown-menu")+'"></'+h+">");for(var k=angular.element(g.querySelector(".df-tab-menu-dropdown")),l=g.querySelectorAll("li[data-menu-item]"),m=angular.element(l),n=0;n<m.length;n++){var o=angular.element(l[n]).clone();o.attr({role:"menuitem"}),k.append(o),angular.element(l[n]).attr({role:"presentation"}),angular.element(l[n]).children().attr({"aria-selected":"false",role:"tab"})}return function(c,d,e){var g=d[0],h=angular.element(a),j=!1,k=function(){var a=g.querySelectorAll("li[data-menu-item][role=presentation]");angular.element(a).removeClass("ng-hide");for(var b=[],c=0;c<a.length;c++){var d=a[c].offsetWidth;d>0&&(b[c]=a[c].offsetWidth)}return b},l=(c.$watch(function(){var a=g.querySelector("li[role=presentation].df-tab-menu-active");return null!=a?a.scrollWidth:0},function(a,b){null!=a&&a>0&&o()},!0),function(){return angular.element(g.querySelector("li[data-more-menu-item]")).removeClass("ng-hide"),g.querySelector("li[data-more-menu-item]").offsetWidth}),m=function(a,b){var c=[],d=k(),e=d[b]+l()+40;c.push(b);for(var f=g.querySelectorAll("li[data-menu-item][role=presentation]"),h=0;h<f.length;h++)if(h!=b){if(e+=d[h],e>a)return c;c.push(h)}return c},n=function(){for(var a=g.querySelectorAll("li[data-menu-item][role=presentation]"),b=0;b<a.length;b++)if(angular.element(a[b]).hasClass("df-tab-menu-active"))return b;return 0},o=function(){var a=g.offsetWidth,b=n(),c=m(a,b),d=g.querySelectorAll("li[data-menu-item][role=presentation]"),e=g.querySelectorAll("li[role=menuitem]"),f=g.querySelector("li[data-more-menu-item]");if(c.length<g.querySelectorAll("li[data-menu-item][role=presentation]").length){angular.element(f).removeClass("ng-hide").attr("aria-hidden","false");for(var h=0;h<d.length;h++)-1!=c.indexOf(h)?(angular.element(d[h]).removeClass("ng-hide").attr("aria-hidden","false"),angular.element(e[h]).addClass("ng-hide").attr("aria-hidden","true")):(angular.element(d[h]).addClass("ng-hide").attr("aria-hidden","true"),angular.element(e[h]).removeClass("ng-hide").attr("aria-hidden","false"))}else angular.element(f).addClass("ng-hide").attr("aria-hidden","true"),angular.element(d).removeClass("ng-hide").attr("aria-hidden","false"),j=!1,q()},p=function(a){j=!1,q(a)},q=function(){j?(i&&angular.element(g.querySelector("li[data-more-menu-item]")).addClass("open"),angular.element(g.querySelector("li[data-more-menu-item] [df-dropdown-toggle]")).addClass("df-tab-menu-dropdown-open").attr({"aria-expanded":"true"}),angular.element(f).bind("click",p)):(i&&angular.element(g.querySelector("li[data-more-menu-item]")).removeClass("open"),angular.element(g.querySelector("li[data-more-menu-item] [df-dropdown-toggle]")).removeClass("df-tab-menu-dropdown-open").attr({"aria-expanded":"false"}),angular.element(f).unbind("click",p))},r=function(a){a&&a.stopPropagation(),j=!j,q()};angular.element(g.querySelector("li[data-more-menu-item] [df-dropdown-toggle]")).bind("click",r);var s=function(a){var b=angular.element(g.querySelector("li.df-tab-menu-active")).removeClass("df-tab-menu-active");b.children().attr("aria-selected","false");var c=angular.element(g.querySelector('li[data-menu-item="'+a+'"][role=presentation]')).addClass("df-tab-menu-active");c.children().attr("aria-selected","true"),i&&(b.removeClass("active"),c.addClass("active"))};e.$observe("menuControl",function(a){o(),s(a)}),h.bind("resize",o),c.$on("$destroy",function(){h.unbind("resize",o),angular.element(g.querySelector("li[data-more-menu-item] [df-dropdown-toggle]")).unbind("click",r),angular.element(f).unbind("click",p)});var t;c.$watch(function(){b.cancel(t),t=b(function(){o(),s(e.menuControl)},25,!1)})}}}}])}();